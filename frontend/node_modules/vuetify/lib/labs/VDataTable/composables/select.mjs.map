{"version":3,"file":"select.mjs","names":["useProxiedModel","computed","inject","provide","propsFactory","makeDataTableSelectProps","showSelect","Boolean","modelValue","type","Array","default","VDataTableSelectionSymbol","Symbol","for","createSelection","props","allItems","selected","v","Set","values","isSelected","items","every","item","value","has","isSomeSelected","some","select","newSelected","add","delete","toggleSelect","selectAll","someSelected","size","allSelected","data","useSelection","Error"],"sources":["../../../../src/labs/VDataTable/composables/select.ts"],"sourcesContent":["// Composables\nimport { useProxiedModel } from '@/composables/proxiedModel'\n\n// Utilities\nimport { computed, inject, provide } from 'vue'\nimport { propsFactory } from '@/util'\n\n// Types\nimport type { InjectionKey, PropType, Ref } from 'vue'\nimport type { ItemProps } from '@/composables/items'\nimport type { DataTableItem } from '../types'\n\nexport const makeDataTableSelectProps = propsFactory({\n  showSelect: Boolean,\n  modelValue: {\n    type: Array as PropType<any[]>,\n    default: () => ([]),\n  },\n}, 'v-data-table-select')\n\nexport const VDataTableSelectionSymbol: InjectionKey<{\n  toggleSelect: (item: DataTableItem) => void\n  select: (items: DataTableItem[], value: boolean) => void\n  selectAll: (value: boolean) => void\n  isSelected: (items: DataTableItem[]) => boolean\n  isSomeSelected: (items: DataTableItem[]) => boolean\n  someSelected: Ref<boolean>\n  allSelected: Ref<boolean>\n}> = Symbol.for('vuetify:data-table-selection')\n\ntype SelectionProps = Pick<ItemProps, 'itemValue'> & { modelValue: any[], 'onUpdate:modelValue': ((value: any[]) => void) | undefined }\n\nexport function createSelection (props: SelectionProps, allItems: Ref<DataTableItem[]>) {\n  const selected = useProxiedModel(props, 'modelValue', props.modelValue, v => {\n    return new Set(v)\n  }, v => {\n    return [...v.values()]\n  })\n\n  function isSelected (items: DataTableItem[]) {\n    return items.every(item => selected.value.has(item.value))\n  }\n\n  function isSomeSelected (items: DataTableItem[]) {\n    return items.some(item => selected.value.has(item.value))\n  }\n\n  function select (items: DataTableItem[], value: boolean) {\n    const newSelected = new Set(selected.value)\n\n    for (const item of items) {\n      if (value) newSelected.add(item.value)\n      else newSelected.delete(item.value)\n    }\n\n    selected.value = newSelected\n  }\n\n  function toggleSelect (item: DataTableItem) {\n    select([item], !isSelected([item]))\n  }\n\n  function selectAll (value: boolean) {\n    select(allItems.value, value)\n  }\n\n  const someSelected = computed(() => selected.value.size > 0)\n  const allSelected = computed(() => isSelected(allItems.value))\n\n  const data = { toggleSelect, select, selectAll, isSelected, isSomeSelected, someSelected, allSelected }\n\n  provide(VDataTableSelectionSymbol, data)\n\n  return data\n}\n\nexport function useSelection () {\n  const data = inject(VDataTableSelectionSymbol)\n\n  if (!data) throw new Error('Missing selection!')\n\n  return data\n}\n"],"mappings":"AAAA;AAAA,SACSA,eAAe,iDAExB;AACA,SAASC,QAAQ,EAAEC,MAAM,EAAEC,OAAO,QAAQ,KAAK;AAAA,SACtCC,YAAY,mCAErB;AAKA,OAAO,MAAMC,wBAAwB,GAAGD,YAAY,CAAC;EACnDE,UAAU,EAAEC,OAAO;EACnBC,UAAU,EAAE;IACVC,IAAI,EAAEC,KAAwB;IAC9BC,OAAO,EAAE,MAAO;EAClB;AACF,CAAC,EAAE,qBAAqB,CAAC;AAEzB,OAAO,MAAMC,yBAQX,GAAGC,MAAM,CAACC,GAAG,CAAC,8BAA8B,CAAC;AAI/C,OAAO,SAASC,eAAe,CAAEC,KAAqB,EAAEC,QAA8B,EAAE;EACtF,MAAMC,QAAQ,GAAGlB,eAAe,CAACgB,KAAK,EAAE,YAAY,EAAEA,KAAK,CAACR,UAAU,EAAEW,CAAC,IAAI;IAC3E,OAAO,IAAIC,GAAG,CAACD,CAAC,CAAC;EACnB,CAAC,EAAEA,CAAC,IAAI;IACN,OAAO,CAAC,GAAGA,CAAC,CAACE,MAAM,EAAE,CAAC;EACxB,CAAC,CAAC;EAEF,SAASC,UAAU,CAAEC,KAAsB,EAAE;IAC3C,OAAOA,KAAK,CAACC,KAAK,CAACC,IAAI,IAAIP,QAAQ,CAACQ,KAAK,CAACC,GAAG,CAACF,IAAI,CAACC,KAAK,CAAC,CAAC;EAC5D;EAEA,SAASE,cAAc,CAAEL,KAAsB,EAAE;IAC/C,OAAOA,KAAK,CAACM,IAAI,CAACJ,IAAI,IAAIP,QAAQ,CAACQ,KAAK,CAACC,GAAG,CAACF,IAAI,CAACC,KAAK,CAAC,CAAC;EAC3D;EAEA,SAASI,MAAM,CAAEP,KAAsB,EAAEG,KAAc,EAAE;IACvD,MAAMK,WAAW,GAAG,IAAIX,GAAG,CAACF,QAAQ,CAACQ,KAAK,CAAC;IAE3C,KAAK,MAAMD,IAAI,IAAIF,KAAK,EAAE;MACxB,IAAIG,KAAK,EAAEK,WAAW,CAACC,GAAG,CAACP,IAAI,CAACC,KAAK,CAAC,MACjCK,WAAW,CAACE,MAAM,CAACR,IAAI,CAACC,KAAK,CAAC;IACrC;IAEAR,QAAQ,CAACQ,KAAK,GAAGK,WAAW;EAC9B;EAEA,SAASG,YAAY,CAAET,IAAmB,EAAE;IAC1CK,MAAM,CAAC,CAACL,IAAI,CAAC,EAAE,CAACH,UAAU,CAAC,CAACG,IAAI,CAAC,CAAC,CAAC;EACrC;EAEA,SAASU,SAAS,CAAET,KAAc,EAAE;IAClCI,MAAM,CAACb,QAAQ,CAACS,KAAK,EAAEA,KAAK,CAAC;EAC/B;EAEA,MAAMU,YAAY,GAAGnC,QAAQ,CAAC,MAAMiB,QAAQ,CAACQ,KAAK,CAACW,IAAI,GAAG,CAAC,CAAC;EAC5D,MAAMC,WAAW,GAAGrC,QAAQ,CAAC,MAAMqB,UAAU,CAACL,QAAQ,CAACS,KAAK,CAAC,CAAC;EAE9D,MAAMa,IAAI,GAAG;IAAEL,YAAY;IAAEJ,MAAM;IAAEK,SAAS;IAAEb,UAAU;IAAEM,cAAc;IAAEQ,YAAY;IAAEE;EAAY,CAAC;EAEvGnC,OAAO,CAACS,yBAAyB,EAAE2B,IAAI,CAAC;EAExC,OAAOA,IAAI;AACb;AAEA,OAAO,SAASC,YAAY,GAAI;EAC9B,MAAMD,IAAI,GAAGrC,MAAM,CAACU,yBAAyB,CAAC;EAE9C,IAAI,CAAC2B,IAAI,EAAE,MAAM,IAAIE,KAAK,CAAC,oBAAoB,CAAC;EAEhD,OAAOF,IAAI;AACb"}